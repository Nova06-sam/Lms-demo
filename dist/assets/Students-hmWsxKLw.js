import{a as O,u as P,r as i,j as e,L as _}from"./index-BgvmjoPK.js";import{m as q,j as D,n as z}from"./index-m96ZVajk.js";import{a as H,b as K,c as Q}from"./index-Cc-SIf8Y.js";import{G as X,a as M,b as B}from"./index-BTQD7Qkc.js";import{B as Y,a as Z}from"./index-BOvcIMEb.js";import{I as ee,a as se}from"./index-C4xZWEtb.js";import{L as te,a as ae}from"./index-B8Dn2etu.js";import{F as ne}from"./index-CkG1-yBZ.js";import{P as re}from"./index-BoYfhb1F.js";import{C as ie}from"./index-DYv1qxzQ.js";import{D as oe}from"./dasboardHeader-Ca8hnp4w.js";import{a as y}from"./index-B9ygI19o.js";import{C as le}from"./code-CMvLa5Vp.js";import"./iconBase-BpTAibu1.js";import"./index-UswyhjMM.js";import"./index-Vs19GYf2.js";import"./clsx-B-dksMZM.js";/* empty css                      */import"./createLucideIcon-DHCVcJg3.js";function ce({min:m}){const C=O(),g=P();i.useEffect(()=>{const a=localStorage.getItem("token"),l=localStorage.getItem("user");if(!a||!l){g("/login");return}},[g]);const j=[{name:"Dashboard",icon:re,path:"/"},{name:"My Courses",icon:ee,path:"/mycourses"},{name:"live classes",icon:ie,path:"/webinar"},{name:"Assessments",icon:ne,path:"/assessment"},{name:"Skill Rating",icon:te,path:"/skillrating"},{name:"Progress",icon:X,path:"/progress"},{name:"Achievements",icon:M,path:"/achievements"},{name:"Certificates",icon:M,path:"/certificates"},{name:"Support",icon:H,path:"/support"}],w=j.findIndex(a=>`/student${a.path}`===C.pathname),N=(a,l)=>{const u=localStorage.getItem("token"),h=localStorage.getItem("user");return!u||!h?(a.preventDefault(),g("/login"),!1):!0};return e.jsx("div",{className:`d-nav fixed top-0 left-0 h-screen flex flex-col gap-3 bg-white w-64 p-5 shadow-md transition-all duration-300 ${m?"action":""}`,children:j.map((a,l)=>{const u=a.icon,h=w===l;return e.jsxs(_,{to:`/student${a.path}`,onClick:r=>N(r,a.path),className:`d-box flex items-center space-x-3 p-3 pl-5 rounded-3xl transition-all duration-300 cursor-pointer ${h?"bg-blue-400 text-white shadow-md transform scale-[1.02]":"text-gray-700 hover:bg-green-500 hover:text-white hover:shadow-md"}`,children:[e.jsx(u,{className:"text-xl"}),e.jsx("span",{className:"font-medium",children:a.name})]},l)})})}const v="http://localhost:5000";function Ee(){const[m,C]=i.useState(null),[g,j]=i.useState(!1),[w,N]=i.useState(0),[a,l]=i.useState(0),[u,h]=i.useState(0),[r,I]=i.useState(!0),[E,de]=i.useState(null),p=P(),L=JSON.parse(sessionStorage.getItem("user"))||JSON.parse(localStorage.getItem("user")),o=L?._id,S=O(),G=["/student","/student/","/student/mycourses","/student/mycourses/","/student/mycourses/videoplayer/:courseId","/student/mycourses/videoplayer/","/student/webinar","/student/webinar/","/student/webinar/webvideoplayer/:webinarId","/student/webinar/webvideoplayer/","/student/webinar/recordedVideo","/student/webinar/recordedVideo/","/student/certificates","/student/certificates/","/student/support","/student/support/","/student/assessment","/student/assessment/","/student/assessment/quiz/:id","/student/assessment/quiz/","/student/skillrating","/student/skillrating/","/student/progress","/student/progress/","/student/achievements","/student/achievements/","/student/live","/student/live/"],A=s=>{const t=Math.floor(s/3600).toString().padStart(2,"0"),n=Math.floor(s%3600/60).toString().padStart(2,"0"),d=(s%60).toString().padStart(2,"0");return`${t}:${n}:${d}`},V=s=>(s/3600).toFixed(1);i.useEffect(()=>{const s=JSON.parse(sessionStorage.getItem("studyTimer"));s&&(l(s.currentSession||0),h(s.totalToday||0),I(s.isRunning??!0))},[]),i.useEffect(()=>{o&&(async()=>{try{const t=await y.get(`${v}/api/dashboard/${o}`);t.data.success&&C(t.data.data)}catch(t){console.error("Error fetching dashboard:",t)}})()},[o]),i.useEffect(()=>{const s=new Date().toISOString().split("T")[0];sessionStorage.getItem("studyTimerDate")!==s&&(sessionStorage.removeItem("studyTimer"),sessionStorage.setItem("studyTimerDate",s),l(0),h(0))},[]),i.useEffect(()=>{sessionStorage.setItem("studyTimer",JSON.stringify({currentSession:a,totalToday:u,isRunning:r}))},[a,u,r]);const T=()=>I(!0),f=()=>{I(!1),h(s=>s+a),l(0),E&&clearTimeout(E)},J=()=>r?f():T();i.useEffect(()=>{let s;return r&&(s=setInterval(()=>l(t=>t+1),1e3)),()=>clearInterval(s)},[r]),i.useEffect(()=>{if(!o||!r)return;const s=setInterval(async()=>{const t=Math.floor(a/60);if(t>0)try{await y.post(`${v}/api/activity/log`,{studentId:o,minutesSpent:t}),l(0)}catch(n){console.error("Error saving time:",n)}},6e4);return()=>clearInterval(s)},[a,r,o]),i.useEffect(()=>{const s=async()=>{if(document.hidden){const n=Math.floor(a/60);n>0&&o&&(await y.post(`${v}/api/activity/log`,{studentId:o,minutesSpent:n}),l(0)),sessionStorage.setItem("lastAwayTime",Date.now())}else{const n=parseInt(sessionStorage.getItem("lastAwayTime"),10),d=Date.now();n&&d-n>6e5?f():T()}},t=async()=>{const n=Math.floor(a/60);n>0&&o&&await y.post(`${v}/api/activity/log`,{studentId:o,minutesSpent:n})};return document.addEventListener("visibilitychange",s),window.addEventListener("beforeunload",t),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("beforeunload",t)}},[a,o]),i.useEffect(()=>{o&&(async()=>{try{const t=await y.get(`${v}/api/activity/${o}`);if(t.data.success&&t.data.data){const{totalTimeSpent:n,dailyLogs:d}=t.data.data,c=JSON.parse(sessionStorage.getItem("studyTimer"));if((!c||c.totalToday===0)&&h(n*60),d&&d.length>0){const b=d.map(x=>new Date(x.date)).sort((x,k)=>k-x);let F=1;for(let x=0;x<b.length-1;x++){const k=(b[x]-b[x+1])/864e5;if(k===1)F++;else if(k>1)break}N(F)}else N(0)}}catch(t){console.error(t)}})()},[o]),i.useEffect(()=>{let s;const t=()=>G.some(c=>{if(c.includes(":")){const b=c.split("/:")[0];return S.pathname.startsWith(b)}return S.pathname===c||S.pathname===c+"/"}),n=()=>{const c=t();document.hidden?(s&&clearTimeout(s),s=setTimeout(()=>{r&&f()},6e5)):(s&&clearTimeout(s),c&&!r&&T())},d=()=>{const c=t();!c&&r?f():c&&!r&&!document.hidden&&T()};return d(),document.addEventListener("visibilitychange",n),window.addEventListener("focus",d),window.addEventListener("blur",n),()=>{document.removeEventListener("visibilitychange",n),window.removeEventListener("focus",d),window.removeEventListener("blur",n),s&&clearTimeout(s)}},[S.pathname,r]);const U=[{name:"Enrolled Courses",no:m?.summary?.enrolledCourses?.total??0,icons:se,sup:"All available courses"},{name:"Skill Rating",no:m?.summary?.skillRating??0,icons:B,sup:"Based on your progress"},{name:"Assessments",no:`${m?.summary?.assessments?.completed??0}/${m?.summary?.assessments?.total??0}`,icons:K,sup:"Completed assessments"},{name:"Live Webinars",no:m?.summary?.webinars?.total??0,icons:Q,sup:`${m?.summary?.webinars?.recorded??0} recordings available`},{name:"Learning Streak",no:`${w||0} days`,icons:q,sup:w>3?"ðŸ”¥ Keep it up!":"Start learning daily!"}],$=m?.lists?.courses??[],R=m?.lists?.assessments??[],W=L;return e.jsxs("main",{children:[e.jsx(oe,{view:g,setShow2:j,userType:"student"}),e.jsxs("section",{className:"student-cover flex",children:[e.jsx(ce,{min:g}),e.jsx("div",{className:"s-details-cover w-full pt-30 p-5 bg-white",children:e.jsxs("div",{className:"student-details",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:["Welcome back, ",W?.name||"Student"]}),e.jsx("p",{className:"text-gray-500",children:"Continue your learning journey with courses and live webinars!"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:U.map((s,t)=>{const n=s.icons;return e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-4 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-800 font-medium",children:s.name}),e.jsx(n,{className:"text-gray-500 text-lg"})]}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:s.no}),e.jsx("p",{className:"text-sm text-gray-500 mt-auto",children:s.sup})]},t)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 shadow-sm",children:[e.jsx("h2",{className:"text-gray-800 font-semibold mb-2",children:"Daily Active Time"}),e.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Track your learning hours today"}),e.jsxs("div",{className:"bg-blue-50 rounded-xl py-6 text-center mb-4",children:[e.jsx("h3",{className:"text-gray-700 text-sm",children:"Current Session"}),e.jsx("p",{className:"text-3xl font-mono font-bold text-blue-600",children:A(a)})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Today"}),e.jsx("p",{className:"font-mono font-bold text-lg",children:A(u+(r?a:0))})]}),e.jsxs("span",{className:"bg-green-100 text-green-700 text-xs font-medium px-3 py-1 rounded-full",children:[V(u+(r?a:0)),"h"]})]}),e.jsxs("div",{className:"timer-bts flex gap-2",children:[e.jsx("button",{onClick:J,className:`flex items-center justify-center w-full font-semibold py-2 rounded-xl transition ${r?"bg-orange-500 hover:bg-orange-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:r?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-2 text-lg"})," Pause Timer"]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"mr-2 text-lg"})," Start Timer"]})}),e.jsx("button",{onClick:f,className:"p-3 bg-gray-100 rounded-xl",children:e.jsx(ae,{className:"text-lg"})})]}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-3",children:"Timer pauses automatically after inactivity"})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 shadow-sm",children:[e.jsx("h2",{className:"text-gray-800 font-semibold mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>p("/student/assessment"),className:"border border-gray-200 hover:bg-green-600 hover:text-white transition rounded-xl py-2 font-medium flex items-center justify-center space-x-2",children:[e.jsx(D,{})," ",e.jsx("span",{children:"View Assessments"})]}),e.jsxs("button",{onClick:()=>p("/student/skillrating"),className:"border border-gray-200 hover:bg-green-600 hover:text-white transition rounded-xl py-2 font-medium flex items-center justify-center space-x-2",children:[e.jsx(B,{})," ",e.jsx("span",{children:"Skill Rating"})]}),e.jsxs("button",{onClick:()=>p("/student/achievements"),className:"border border-gray-200 hover:bg-green-600 hover:text-white transition rounded-xl py-2 font-medium flex items-center justify-center space-x-2",children:[e.jsx(D,{})," ",e.jsx("span",{children:"Achievements"})]}),e.jsxs("button",{onClick:()=>p("/student/support"),className:"border border-gray-200 hover:bg-green-600 hover:text-white transition rounded-xl py-2 font-medium flex items-center justify-center space-x-2",children:[e.jsx(D,{})," ",e.jsx("span",{children:"Get Support"})]})]})]})]}),e.jsx("div",{className:"stud-bot w-full flex flex-col lg:flex-row gap-2 mt-6",children:e.jsxs("div",{className:"student-bot w-full flex gap-2 mt-6",children:[e.jsxs("div",{className:"c-details pt-2 w-full lg:w-2/3",children:[e.jsxs("div",{className:"c-head flex justify-between p-4",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Continue Learning"}),e.jsxs("button",{className:"border border-gray-200 hover:bg-green-600 hover:text-white transition rounded-xl py-2 font-medium flex items-center justify-center space-x-2 p-3",children:[e.jsx(z,{})," ",e.jsx("span",{children:"Filter"})]})]}),$.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pt-5",children:$.map(s=>e.jsxs("div",{className:"bg-white card-box shadow-md rounded-3xl overflow-hidden",children:[e.jsx("img",{src:s.thumbnail||le,alt:"course",className:"w-full h-60 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.courseTitle||"Untitled Course"}),e.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:[s.courseCategory||"General"," â€¢"," ",s.courseLevel||"Beginner"]}),e.jsx("a",{onClick:()=>p(`/student/mycourses/videoplayer/${s._id}`),className:"block bg-blue-600 text-white text-center py-2 rounded-lg font-medium hover:bg-blue-700 transition mt-6 mb-5 cursor-pointer",children:"Continue Learning"})]})]},s._id))}):e.jsx("p",{className:"text-gray-500 p-5",children:"No courses available."})]}),e.jsxs("div",{className:"c-upcome flex flex-col pt-8 gap-5 p-3 w-full lg:w-1/3",children:[e.jsx("h1",{className:"text-2xl font-bold pb-5",children:"Upcoming"}),R.length>0?R.map((s,t)=>e.jsxs("div",{className:"upcome-box flex flex-col bg-white rounded-3xl border border-gray-300 p-4 w-full",children:[e.jsxs("div",{className:"flex justify-between mb-3",children:[e.jsx("span",{children:e.jsx("small",{className:"bg-gray-400 text-white px-3 py-1 rounded-xl",children:"Pending"})}),e.jsx("span",{children:e.jsx("small",{className:"bg-yellow-500 text-white px-3 py-1 rounded-xl",children:"New"})})]}),e.jsx("h4",{className:"mb-1",children:s.title||"Untitled Assessment"}),e.jsx("small",{className:"text-gray-400 mb-3",children:s.courseName||"General Course"}),e.jsx("button",{onClick:()=>p("/student/assessment"),className:"w-full bg-blue-500 text-white hover:bg-blue-800 p-1 rounded-2xl font-bold",children:"Start Assessment"})]},t)):e.jsx("p",{className:"text-gray-500",children:"No pending assessments ðŸŽ¯"})]})]})})]})})]})]})}export{Ee as default};
