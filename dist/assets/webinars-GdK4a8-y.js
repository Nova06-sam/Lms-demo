import{r as o,u as W,j as e,L as U}from"./index-BgvmjoPK.js";import{i as x,j as g,k as E,l as v}from"./index-CkG1-yBZ.js";import{n as V,v as L,w as $}from"./index-m96ZVajk.js";import{C as T}from"./code-CMvLa5Vp.js";import{B as A}from"./BackDashboard-cToXFvJ9.js";import{a as h}from"./index-B9ygI19o.js";import"./hls-CiLLo4G9.js";import"./iconBase-BpTAibu1.js";import"./index-UswyhjMM.js";function K(){const[p,w]=o.useState(""),[j,C]=o.useState([]),[c,f]=o.useState([]),[n,y]=o.useState({webinar:!0,recorded:!0,live:!1}),[a,u]=o.useState("all"),k=W();o.useEffect(()=>{N()},[]);const N=async()=>{try{try{const s=await h.get("http://localhost:5000/api/webinar/all");C(s.data.data||s.data)}catch(s){console.error("Error fetching webinars:",s)}finally{y(s=>({...s,webinar:!1}))}try{const s=await h.get("http://localhost:5000/api/live/recorded/all/video");f(s.data||[])}catch(s){console.error("Error fetching recorded videos:",s),f([])}finally{y(s=>({...s,recorded:!1}))}try{const s=await h.get("http://localhost:5000/api/live/latest");s.data&&s.data.playbackUrl&&w(s.data.playbackUrl)}catch(s){console.log("No live session available:",s)}}catch(s){console.error("General fetch error:",s)}};console.log("playbackUrl",p);const S=async s=>{try{const t=await h.get(`http://localhost:5000/api/live/recorded/video/${s}`);console.log("Fetched recorded video:",t.data),console.log(s),k("/student/webinar/recordedVideo",{state:{video:t.data}})}catch(t){console.error("Error fetching recorded video:",t),alert("Failed to load recorded video")}},R=s=>{const t=new Date,m=s.webinarSchedule?.startDate?new Date(s.webinarSchedule.startDate):null;let r="Upcoming",l="bg-blue-600",i="View Details",b=e.jsx(L,{className:"inline mr-1"});return s.status==="live"||s.status==="ongoing"?(r="Live Now",l="bg-red-600",i="Join Webinar",b=e.jsx($,{className:"inline mr-1"})):s.status==="completed"||s.status==="recorded"?(r="Recording Available",l="bg-gray-700",i="Watch Recording",b=e.jsx(g,{className:"inline mr-1"})):m&&m<t&&(r="Completed",l="bg-gray-600",i="View Details"),{status:r,statusColor:l,buttonText:i,icon:b}},D=({webinar:s})=>{const{status:t,statusColor:m,buttonText:r,icon:l}=R(s),i=s.webinarSchedule?.sessions?.[0]?.topic||s.agenda?.[0]?.topic||s.category;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition hover:scale-[1.02] duration-300",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.thumbnail||T,alt:s.title,className:"w-full h-48 object-cover"}),e.jsx("span",{className:`absolute top-3 right-3 text-xs px-3 py-1 rounded-full text-white ${m}`,children:t})]}),e.jsxs("div",{className:"p-5 flex flex-col justify-between h-[calc(100%-12rem)]",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-1 text-base line-clamp-2 h-12",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-500 mb-3 flex items-center",children:[e.jsx(E,{className:"mr-1"})," by ",i]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[s.webinarSchedule?.startDate&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(x,{}),new Date(s.webinarSchedule.startDate).toLocaleDateString("en-US")]}),s.duration&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(v,{})," ",s.duration]})]})]}),e.jsxs(U,{to:`/student/webinar/webvideoplayer/${s._id}`,state:{webinar:s},className:"mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium py-2.5 rounded-lg transition flex items-center justify-center gap-2",children:[l,r]})]})]})},F=({video:s,index:t})=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition hover:scale-[1.02] duration-300",children:e.jsxs("div",{className:"p-5 flex flex-col justify-between h-full",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-800 text-base line-clamp-2 flex-1",children:s.title||`Recorded Session ${t+1}`}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-700 ml-2",children:"Recorded"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[s.date&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(x,{}),new Date(s.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),s.duration&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(v,{})," ",s.duration]})]})]}),e.jsxs("button",{onClick:()=>S(s._id),className:"mt-4 w-full bg-gray-800 hover:bg-gray-900 text-white text-sm font-medium py-2.5 rounded-lg transition flex items-center justify-center gap-2",children:[e.jsx(g,{}),"Watch Recorded Video"]})]})}),d=j.filter(s=>a==="upcoming"?s.status==="upcoming"||s.status==="schedule":a==="completed"?s.status==="completed"||s.status==="recorded":!0);return console.log("Filtered Webinars:",d),e.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 md:p-6 lg:pt-20 ",children:[e.jsx(A,{}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Live Webinars"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Upcoming, Live & Recorded Sessions"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-4 md:mt-0",children:[e.jsxs("div",{className:"flex bg-white border border-gray-300 rounded-xl overflow-hidden",children:[e.jsx("button",{onClick:()=>u("all"),className:`px-4 py-2 text-sm font-medium transition ${a==="all"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"All"}),e.jsx("button",{onClick:()=>u("upcoming"),className:`px-4 py-2 text-sm font-medium transition ${a==="upcoming"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"Upcoming"}),e.jsx("button",{onClick:()=>u("completed"),className:`px-4 py-2 text-sm font-medium transition ${a==="completed"?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:"Completed"})]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-100 transition",children:[e.jsx(V,{}),e.jsx("span",{className:"hidden sm:inline",children:"Filter"})]})]})]}),e.jsxs("div",{className:"mb-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:a==="all"?"All Webinars":a==="upcoming"?"Upcoming Webinars":"Completed Webinars"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[d.length," webinar",d.length!==1?"s":""]})]}),n.webinar?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsx("div",{className:"animate-pulse bg-gray-200 rounded-2xl h-80"},s))}):d.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl border border-gray-200",children:[e.jsx(x,{className:"text-4xl text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No webinars found"}),e.jsx("p",{className:"text-gray-500",children:a==="all"?"There are no webinars available at the moment.":a==="upcoming"?"No upcoming webinars scheduled.":"No completed webinars available."})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map((s,t)=>e.jsx(D,{webinar:s},t))})]}),e.jsxs("div",{className:"mb-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"text-gray-700"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Recorded Sessions"})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[c.length," recording",c.length!==1?"s":""]})]}),n.recorded?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsx("div",{className:"animate-pulse bg-gray-200 rounded-2xl h-48"},s))}):c.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl border border-gray-200",children:[e.jsx(g,{className:"text-4xl text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No recorded sessions"}),e.jsx("p",{className:"text-gray-500",children:"Recorded videos will appear here after live sessions end."})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((s,t)=>e.jsx(F,{video:s,index:t},s._id||t))})]}),!n.webinar&&!n.recorded&&j.length===0&&c.length===0&&!p&&e.jsx("div",{className:"text-center py-20",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md mx-auto shadow-sm border",children:[e.jsx(x,{className:"text-5xl text-gray-400 mx-auto mb-6"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:"No webinars available"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Check back later for upcoming live sessions and recorded webinars."}),e.jsx("button",{onClick:N,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",children:"Refresh"})]})})]})}export{K as default};
